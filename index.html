<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>অ্যাডমিন প্যানেল</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans Bengali', sans-serif; background-color: #f0f2f5; margin: 0; padding: 20px; }
        .container { max-width: 800px; margin: auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1, h2 { color: #333; text-align: center; }
        .add-post-section { margin-bottom: 30px; }
        textarea { width: 100%; height: 120px; padding: 10px; border: 1px solid #ccc; border-radius: 5px; font-size: 16px; box-sizing: border-box; }
        .btn { border: none; padding: 12px 20px; font-size: 16px; font-weight: 500; border-radius: 5px; cursor: pointer; transition: background-color 0.3s; color: white; }
        .btn-add { background-color: #007bff; display: block; width: 100%; margin-top: 10px; }
        .post-list { margin-top: 20px; }
        .post-item { background: #f9f9f9; border: 1px solid #eee; padding: 15px; border-radius: 5px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
        .post-content { flex-grow: 1; margin-right: 15px; white-space: pre-wrap; word-break: break-word; }
        .post-actions .btn { margin-left: 10px; }
        .btn-edit { background-color: #ffc107; }
        .btn-delete { background-color: #dc3545; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5); }
        .modal-content { background-color: #fefefe; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 500px; border-radius: 8px; }
        .modal-content textarea { height: 150px; }
        .close-btn { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>
    <div class="container">
        <h1>অ্যাডমিন প্যানেল</h1>
        <div class="add-post-section">
            <h2>নতুন পোস্ট যোগ করুন</h2>
            <textarea id="postContent" placeholder="এখানে নতুন পোস্ট লিখুন..."></textarea>
            <button class="btn btn-add" onclick="addPost()">পোস্ট যোগ করুন</button>
        </div>
        <hr>
        <h2>সকল পোস্ট ম্যানেজ করুন</h2>
        <div id="postList" class="post-list">পোস্ট লোড হচ্ছে...</div>
    </div>

    <!-- Edit Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <h3>পোস্ট এডিট করুন</h3>
            <textarea id="editPostContent"></textarea>
            <button class="btn btn-add" id="saveChangesBtn">পরিবর্তন সেভ করুন</button>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAjcAv64YFJndEMptOWfGTmR5LG-8ymSdE",
            authDomain: "genaretor.firebaseapp.com",
            databaseURL: "https://genaretor-default-rtdb.firebaseio.com",
            projectId: "genaretor",
            storageBucket: "genaretor.appspot.com",
            messagingSenderId: "44288000929",
            appId: "1:44288000929:web:06e297c4fae8ec22eb81e0"
        };
        
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const database = firebase.database();
        const postsRef = database.ref('posts');
        const postListDiv = document.getElementById('postList');
        const modal = document.getElementById('editModal');

        function addPost() {
            const postContent = document.getElementById('postContent').value;
            if (postContent.trim() === "") {
                alert("দয়া করে কিছু লিখুন।");
                return;
            }
            postsRef.push({ content: postContent, timestamp: Date.now() })
                .then(() => {
                    document.getElementById('postContent').value = '';
                    alert("পোস্ট যোগ করা হয়েছে!");
                });
        }

        postsRef.on('value', (snapshot) => {
            postListDiv.innerHTML = '';
            const data = snapshot.val();
            if (data) {
                Object.entries(data).forEach(([key, value]) => {
                    const postItem = document.createElement('div');
                    postItem.className = 'post-item';
                    postItem.innerHTML = `
                        <div class="post-content">${value.content}</div>
                        <div class="post-actions">
                            <button class="btn btn-edit" onclick="openEditModal('${key}', \`${value.content}\`)">এডিট</button>
                            <button class="btn btn-delete" onclick="deletePost('${key}')">ডিলেট</button>
                        </div>
                    `;
                    postListDiv.appendChild(postItem);
                });
            } else {
                postListDiv.innerHTML = "কোনো পোস্ট পাওয়া যায়নি।";
            }
        });

        function deletePost(key) {
            if (confirm("আপনি কি নিশ্চিতভাবে এই পোস্টটি ডিলেট করতে চান?")) {
                postsRef.child(key).remove();
            }
        }

        function openEditModal(key, content) {
            document.getElementById('editPostContent').value = content;
            document.getElementById('saveChangesBtn').onclick = () => saveChanges(key);
            modal.style.display = 'block';
        }

        function closeModal() {
            modal.style.display = 'none';
        }

        function saveChanges(key) {
            const newContent = document.getElementById('editPostContent').value;
            if (newContent.trim() === "") {
                alert("পোস্ট খালি রাখা যাবে না।");
                return;
            }
            postsRef.child(key).update({ content: newContent })
                .then(() => {
                    closeModal();
                    alert("পোস্ট সফলভাবে আপডেট করা হয়েছে!");
                });
        }

        window.onclick = function(event) {
            if (event.target == modal) {
                closeModal();
            }
        }
    </script>
</body>
</html>
